{"ast":null,"code":"import _objectSpread from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/LoginPage.js\";\nimport './App.css';\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport SignIn from '../components/SignIn';\nvar LoginPage = function LoginPage() {\n  var navigate = useNavigate;\n  var _useState = useState({\n      user: {},\n      error: \"\"\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    userInfo = _useState2[0],\n    setInfo = _useState2[1];\n  useEffect(function () {\n    console.log('hit');\n    var token = localStorage.getItem('token');\n    if (token) {\n      fetch('http://localhost:3000/profile', {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": \"Bearer \".concat(token)\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (result) {\n        if (result.id) {\n          setInfo(_objectSpread({}, userInfo, {\n            user: result\n          }));\n        }\n      });\n    }\n  }, []);\n  var signIn = function signIn(user) {\n    fetch(\"http://localhost:3000/login\", {\n      method: \"POST\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        user: {\n          username: user.username,\n          password: user.password\n        }\n      })\n    }).then(function (response) {\n      return response.json();\n    }).then(function (result) {\n      if (result.token) {\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('user', result.user);\n        setInfo(_objectSpread({}, userInfo, {\n          user: result.user\n        }));\n        navigate('/home');\n      } else {\n        setInfo(_objectSpread({}, userInfo, {\n          error: result.error\n        }));\n      }\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(SignIn, {\n    signIn: signIn,\n    error: userInfo['error'],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }));\n};\nexport default LoginPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","SignIn","LoginPage","navigate","user","error","userInfo","setInfo","console","log","token","localStorage","getItem","fetch","method","headers","then","response","json","result","id","signIn","body","JSON","stringify","username","password","setItem"],"sources":["/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/LoginPage.js"],"sourcesContent":["import './App.css';\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from \"react-router-dom\";\n\nimport SignIn from '../components/SignIn';\n\nconst LoginPage = () => {\n  const navigate = useNavigate;\n  const [userInfo, setInfo] = useState({\n    user: {}, \n    error: \"\",\n  });\n\n  useEffect(() => {\n    console.log('hit');\n    let token = localStorage.getItem('token');\n    if(token){\n      fetch('http://localhost:3000/profile', {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": `Bearer ${token}`\n        }\n      })\n      .then(response => response.json())\n      .then(result => {\n        if(result.id){\n          setInfo({\n            ...userInfo, \n            user: result\n          })\n        }\n      })\n    }\n  }, []\n  );\n\n  const signIn = (user) => {\n    fetch(\"http://localhost:3000/login\", {\n        method: \"POST\",\n        headers: {\n            \"Accept\": \"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            user: {\n                username: user.username,\n                password: user.password\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.token){\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('user', result.user);\n        setInfo({\n            ...userInfo,\n            user: result.user\n            });\n        navigate('/home')\n        }\n        else {\n            setInfo({\n              ...userInfo,\n              error: result.error\n            });\n        }\n    })\n  }\n\n  return (\n    <div className=\"App\">\n      {\n        <SignIn signIn={signIn} error={userInfo['error']} />\n      }\n      \n    </div>\n  );\n} \n\nexport default LoginPage;"],"mappings":";;;;AAAA,OAAO,WAAW;AAClB,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,OAAOC,MAAM,MAAM,sBAAsB;AAEzC,IAAMC,SAAS,GAAG,SAAZA,SAAS,GAAS;EACtB,IAAMC,QAAQ,GAAGH,WAAW;EAAC,gBACDF,QAAQ,CAAC;MACnCM,IAAI,EAAE,CAAC,CAAC;MACRC,KAAK,EAAE;IACT,CAAC,CAAC;IAAA;IAHKC,QAAQ;IAAEC,OAAO;EAKxBR,SAAS,CAAC,YAAM;IACdS,OAAO,CAACC,GAAG,CAAC,KAAK,CAAC;IAClB,IAAIC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IACzC,IAAGF,KAAK,EAAC;MACPG,KAAK,CAAC,+BAA+B,EAAE;QACrCC,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UACP,eAAe,mBAAYL,KAAK;QAClC;MACF,CAAC,CAAC,CACDM,IAAI,CAAC,UAAAC,QAAQ;QAAA,OAAIA,QAAQ,CAACC,IAAI,EAAE;MAAA,EAAC,CACjCF,IAAI,CAAC,UAAAG,MAAM,EAAI;QACd,IAAGA,MAAM,CAACC,EAAE,EAAC;UACXb,OAAO,mBACFD,QAAQ;YACXF,IAAI,EAAEe;UAAM,GACZ;QACJ;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,EAAE,CACJ;EAED,IAAME,MAAM,GAAG,SAATA,MAAM,CAAIjB,IAAI,EAAK;IACvBS,KAAK,CAAC,6BAA6B,EAAE;MACjCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,QAAQ,EAAE,kBAAkB;QAC5B,cAAc,EAAE;MACpB,CAAC;MACDO,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QACjBpB,IAAI,EAAE;UACFqB,QAAQ,EAAErB,IAAI,CAACqB,QAAQ;UACvBC,QAAQ,EAAEtB,IAAI,CAACsB;QACnB;MACJ,CAAC;IACL,CAAC,CAAC,CACDV,IAAI,CAAC,UAAAC,QAAQ;MAAA,OAAIA,QAAQ,CAACC,IAAI,EAAE;IAAA,EAAC,CACjCF,IAAI,CAAC,UAAAG,MAAM,EAAI;MACZ,IAAIA,MAAM,CAACT,KAAK,EAAC;QACjBC,YAAY,CAACgB,OAAO,CAAC,OAAO,EAAER,MAAM,CAACT,KAAK,CAAC;QAC3CC,YAAY,CAACgB,OAAO,CAAC,MAAM,EAAER,MAAM,CAACf,IAAI,CAAC;QACzCG,OAAO,mBACAD,QAAQ;UACXF,IAAI,EAAEe,MAAM,CAACf;QAAI,GACf;QACND,QAAQ,CAAC,OAAO,CAAC;MACjB,CAAC,MACI;QACDI,OAAO,mBACFD,QAAQ;UACXD,KAAK,EAAEc,MAAM,CAACd;QAAK,GACnB;MACN;IACJ,CAAC,CAAC;EACJ,CAAC;EAED,oBACE;IAAK,SAAS,EAAC,KAAK;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBAEhB,oBAAC,MAAM;IAAC,MAAM,EAAEgB,MAAO;IAAC,KAAK,EAAEf,QAAQ,CAAC,OAAO,CAAE;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EAAG,CAGlD;AAEV,CAAC;AAED,eAAeJ,SAAS"},"metadata":{},"sourceType":"module"}