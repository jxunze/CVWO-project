{"ast":null,"code":"import _slicedToArray from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/CommentPage.js\";\n// comments \nimport React, { useState, useEffect } from \"react\";\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\nimport Comments from \"../components/commentpage/Comments\";\nimport Navbar from '../components/NavBar.js';\nimport NewComment from \"../components/commentpage/NewComment\";\nvar CommentPage = function CommentPage() {\n  var params = useParams();\n  var navigate = useNavigate();\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    comments = _useState2[0],\n    setComments = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    post = _useState4[0],\n    setPost = _useState4[1];\n  var _useState5 = useState(\"\"),\n    _useState6 = _slicedToArray(_useState5, 2),\n    newComment = _useState6[0],\n    setNewComment = _useState6[1];\n  useEffect(function () {\n    var token = localStorage.getItem(\"token\");\n    var commentURL = \"http://localhost:3000/comments/\".concat(params.id);\n    var showPostURL = \"http://localhost:3000/posts/\".concat(params.id);\n    if (token) {\n      fetch(showPostURL, {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": \"Bearer \".concat(token)\n        }\n      }).then(function (response) {\n        if (response.ok) {\n          return response.json();\n        }\n        throw new Error(\"Network response was not ok.\");\n      }).then(function (response) {\n        return setPost(response);\n      });\n      fetch(commentURL, {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": \"Bearer \".concat(token)\n        }\n      }).then(function (response) {\n        if (response.ok) {\n          return response.json();\n        }\n        throw new Error(\"Network response was not ok.\");\n      }).then(function (response) {\n        return setComments(response);\n      });\n    }\n  }, []);\n  var stripHtmlEntities = function stripHtmlEntities(str) {\n    return String(str).replace(/\\n/g, \"<br> <br>\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n  };\n  var onSubmit = function onSubmit(event, comment) {\n    event.preventDefault();\n    var url = \"http://localhost:3000/posts\";\n    if (comment.length === 0) return;\n    var info = {\n      post: {\n        body: stripHtmlEntities(comment)\n      }\n    };\n    console.log(JSON.stringify(info));\n    var auth_token = localStorage.getItem('token');\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \".concat(auth_token)\n      },\n      body: JSON.stringify(info)\n    }).then(function (response) {\n      if (response.ok) {\n        return response.json();\n      }\n      throw new Error(\"Network response was not ok.\");\n    }).then(function () {\n      return window.location.reload(false);\n    }).catch(function (error) {\n      return console.log(error.message);\n    });\n    console.log(\"3\");\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    user: localStorage.getItem('username'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    className: \"container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    key: post.id,\n    className: \"col-md-6 col-lg-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card mb-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"card-title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 15\n    }\n  }, post.name), /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"card-title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 15\n    }\n  }, post.title), /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"card-title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, post.body)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-end mb-3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(NewComment, {\n    id: params.id,\n    onSubmit: onSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Comments, {\n    comments: comments,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  })));\n};\nexport default CommentPage;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useParams","Comments","Navbar","NewComment","CommentPage","params","navigate","comments","setComments","post","setPost","newComment","setNewComment","token","localStorage","getItem","commentURL","id","showPostURL","fetch","method","headers","then","response","ok","json","Error","stripHtmlEntities","str","String","replace","onSubmit","event","comment","preventDefault","url","length","info","body","console","log","JSON","stringify","auth_token","window","location","reload","catch","error","message","name","title"],"sources":["/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/CommentPage.js"],"sourcesContent":["// comments \nimport React, { useState, useEffect } from \"react\";\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\nimport Comments from \"../components/commentpage/Comments\";\nimport Navbar from '../components/NavBar.js';\nimport NewComment from \"../components/commentpage/NewComment\";\n\nconst CommentPage = () => {\n  const params = useParams();\n  const navigate = useNavigate();\n  const [comments, setComments] = useState([]);\n  const [post, setPost] = useState([]);\n  const [newComment, setNewComment] = useState(\"\");\n\n  useEffect(() => {\n    let token = localStorage.getItem(\"token\")\n    const commentURL = `http://localhost:3000/comments/${params.id}`;\n    const showPostURL = `http://localhost:3000/posts/${params.id}`\n    if (token){\n        fetch(showPostURL, {\n            method: \"GET\",\n            headers: {\n            \"Authorization\": `Bearer ${token}`\n            }\n        })\n        .then((response) => {\n        if (response.ok) {\n            return response.json();\n        }\n        throw new Error(\"Network response was not ok.\");\n        })\n        .then((response) => setPost(response));\n\n        fetch(commentURL, {\n            method: \"GET\",\n            headers: {\n            \"Authorization\": `Bearer ${token}`\n            }\n        })\n        .then((response) => {\n            if (response.ok) {\n            return response.json();\n            }\n            throw new Error(\"Network response was not ok.\");\n        })\n        .then((response) => setComments(response));\n    }\n  }, []);\n\n  const stripHtmlEntities = (str) => {\n    return String(str)\n      .replace(/\\n/g, \"<br> <br>\")\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\");\n  };\n  \n  const onSubmit = (event, comment) => {\n      event.preventDefault();\n      const url = \"http://localhost:3000/posts\";\n  \n      if (comment.length === 0)\n        return;\n      const info = {\n        post: {\n          body: stripHtmlEntities(comment),\n        }\n      };\n      \n      console.log(JSON.stringify(info))\n      const auth_token = localStorage.getItem('token');\n      fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${auth_token}`\n        },\n        body: JSON.stringify(info),\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error(\"Network response was not ok.\");\n        })\n        .then(()=>window.location.reload(false))\n        .catch((error) => console.log(error.message));\n        console.log(\"3\")\n    };\n\n  return(\n    <div>\n      <Navbar user={localStorage.getItem('username')}/>\n      <main className=\"container\">\n        <div key={post.id} className=\"col-md-6 col-lg-4\">\n          <div className=\"card mb-4\">\n            <div className=\"card-body\">\n              <h5 className=\"card-title\">{post.name}</h5>\n              <h5 className=\"card-title\">{post.title}</h5>\n              <h5 className=\"card-title\">{post.body}</h5>\n            </div>\n          </div>\n        </div>\n        <div className=\"text-end mb-3\">\n            <NewComment id={params.id} onSubmit={onSubmit}/>\n        </div>\n          <Comments comments = {comments}/>\n        </main>\n    </div>\n    \n  )\n  \n};\n\nexport default CommentPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}