{"ast":null,"code":"import _slicedToArray from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/EditPostPage.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport Posts from \"../components/postpage/Posts\";\nimport Navbar from \"../components/NavBar.js\";\nimport EditPost from \"../components/EditPost\";\nimport Dropdown from \"react-bootstrap/Dropdown\";\nvar EditPostPage = function EditPostPage() {\n  var navigate = useNavigate();\n  var _useState = useState({\n      user: {},\n      error: \"\"\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    userInfo = _useState2[0],\n    setInfo = _useState2[1];\n  var params = useParams();\n  var _useState3 = useState({\n      title: \"\",\n      body: \"\"\n    }),\n    _useState4 = _slicedToArray(_useState3, 2),\n    formInfo = _useState4[0],\n    setFormInfo = _useState4[1];\n  useEffect(function () {\n    var token = localStorage.getItem(\"token\");\n    var showPostURL = \"http://localhost:3000/posts/\".concat(params.id);\n    if (token) {\n      fetch(showPostURL, {\n        method: \"GET\",\n        headers: {\n          Authorization: \"Bearer \".concat(token)\n        }\n      }).then(function (response) {\n        if (response.ok) {\n          return response.json();\n        }\n        throw new Error(\"Network response was not ok.\");\n      }).then(function (response) {\n        setFormInfo({\n          title: response.title,\n          body: response.body\n        });\n      }).catch(function (error) {\n        return console.log(error.message);\n      });\n    }\n  }, []);\n  var stripHtmlEntities = function stripHtmlEntities(str) {\n    return String(str).replace(/\\n/g, \"<br> <br>\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n  };\n  var onSubmit = function onSubmit(event, title, body) {\n    event.preventDefault();\n    var url = \"http://localhost:3000/posts/\".concat(params.id);\n    if (title.length === 0 || body.length === 0) return;\n    var info = {\n      post: {\n        title: title,\n        body: stripHtmlEntities(body)\n      }\n    };\n    setFormInfo({\n      title: \"\",\n      body: \"\"\n    });\n    var auth_token = localStorage.getItem(\"token\");\n    fetch(url, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \".concat(auth_token)\n      },\n      body: JSON.stringify(info)\n    }).then(function (response) {\n      if (response.ok) {\n        return response.json();\n      }\n      throw new Error(\"Network response was not ok.\");\n    }).then(function () {\n      navigate(\"/home\");\n    }).catch(function (error) {\n      return console.log(error.message);\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    user: localStorage.getItem(\"username\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    className: \"mainpage\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"new-post\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(EditPost, {\n    submit: onSubmit,\n    onChange: setFormInfo,\n    info: formInfo,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }\n  }))));\n};\nexport default EditPostPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useParams","Posts","Navbar","EditPost","Dropdown","EditPostPage","navigate","user","error","userInfo","setInfo","params","title","body","formInfo","setFormInfo","token","localStorage","getItem","showPostURL","id","fetch","method","headers","Authorization","then","response","ok","json","Error","catch","console","log","message","stripHtmlEntities","str","String","replace","onSubmit","event","preventDefault","url","length","info","post","auth_token","JSON","stringify"],"sources":["/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/EditPostPage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport Posts from \"../components/postpage/Posts\";\nimport Navbar from \"../components/NavBar.js\";\nimport EditPost from \"../components/EditPost\";\nimport Dropdown from \"react-bootstrap/Dropdown\";\n\nconst EditPostPage = () => {\n  const navigate = useNavigate();\n  const [userInfo, setInfo] = useState({\n    user: {},\n    error: \"\",\n  });\n  const params = useParams();\n\n  const [formInfo, setFormInfo] = useState({\n    title: \"\",\n    body: \"\",\n  });\n\n  useEffect(() => {\n    let token = localStorage.getItem(\"token\");\n    const showPostURL = `http://localhost:3000/posts/${params.id}`;\n    if (token) {\n      fetch(showPostURL, {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error(\"Network response was not ok.\");\n        })\n        .then((response) => {\n          setFormInfo({ title: response.title, body: response.body });\n        })\n        .catch((error) => console.log(error.message));\n    }\n  }, []);\n\n  const stripHtmlEntities = (str) => {\n    return String(str)\n      .replace(/\\n/g, \"<br> <br>\")\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\");\n  };\n\n  const onSubmit = (event, title, body) => {\n    event.preventDefault();\n    const url = `http://localhost:3000/posts/${params.id}`;\n\n    if (title.length === 0 || body.length === 0) return;\n    const info = {\n      post: {\n        title,\n        body: stripHtmlEntities(body),\n      },\n    };\n\n    setFormInfo({\n      title: \"\",\n      body: \"\",\n    });\n\n    const auth_token = localStorage.getItem(\"token\");\n    fetch(url, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${auth_token}`,\n      },\n      body: JSON.stringify(info),\n    })\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        }\n        throw new Error(\"Network response was not ok.\");\n      })\n      .then(() => {\n        navigate(\"/home\");\n      })\n      .catch((error) => console.log(error.message));\n  };\n\n  return (\n    <div>\n      <Navbar user={localStorage.getItem(\"username\")} />\n      <main className=\"mainpage\">\n        <div className=\"new-post\">\n          <EditPost submit={onSubmit} onChange={setFormInfo} info={formInfo} />\n        </div>\n      </main>\n    </div>\n  );\n};\nexport default EditPostPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}