{"ast":null,"code":"import _objectSpread from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/LoginPage.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport Navbar from '../components/NavBar.js';\nimport SignIn from '../components/SignIn';\nvar LoginPage = function LoginPage() {\n  var navigate = useNavigate();\n  var _useState = useState({\n      user: {},\n      error: \"\"\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    userInfo = _useState2[0],\n    setInfo = _useState2[1]; // useEffect(() => {\n  //   console.log('hit');\n  //   let token = localStorage.getItem('token');\n  //   if(token){\n  //     fetch('http://localhost:3000/profile', {\n  //       method: \"GET\",\n  //       headers: {\n  //         \"Authorization\": `Bearer ${token}`\n  //       }\n  //     })\n  //     .then(response => response.json())\n  //     .then(result => {\n  //       if(result.id){\n  //         setInfo({\n  //           ...userInfo, \n  //           user: result\n  //         })\n  //       }\n  //     })\n  //   }\n  // }, []\n  // );\n  var signIn = function signIn(user) {\n    fetch(\"http://localhost:3000/login/\", {\n      method: \"POST\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        user: {\n          username: user.username,\n          password: user.password\n        }\n      })\n    }).then(function (response) {\n      return response.json();\n    }).then(function (result) {\n      console.log(result);\n      if (result.token) {\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('username', result.username);\n        localStorage.setItem('user_id', result.user_id);\n        setInfo(_objectSpread({}, userInfo, {\n          user: result.user\n        }));\n        navigate(\"/home\");\n      } else {\n        setInfo(_objectSpread({}, userInfo, {\n          error: result.error\n        }));\n      }\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    user: localStorage.getItem('username'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(SignIn, {\n    signIn: signIn,\n    error: userInfo['error'],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }));\n};\nexport default LoginPage;","map":{"version":3,"names":["React","useState","useEffect","Navigate","useNavigate","Navbar","SignIn","LoginPage","navigate","user","error","userInfo","setInfo","signIn","fetch","method","headers","body","JSON","stringify","username","password","then","response","json","result","console","log","token","localStorage","setItem","user_id","getItem"],"sources":["/Users/xunze/Local Documents/Grind/Personal Projects/CVWO/proj2/final_forum/frontend/src/Pages/LoginPage.js"],"sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport Navbar from '../components/NavBar.js'\n\nimport SignIn from '../components/SignIn';\n\nconst LoginPage = () => {\n  const navigate = useNavigate();\n  const [userInfo, setInfo] = useState({\n    user: {}, \n    error: \"\",\n  });\n\n  // useEffect(() => {\n  //   console.log('hit');\n  //   let token = localStorage.getItem('token');\n  //   if(token){\n  //     fetch('http://localhost:3000/profile', {\n  //       method: \"GET\",\n  //       headers: {\n  //         \"Authorization\": `Bearer ${token}`\n  //       }\n  //     })\n  //     .then(response => response.json())\n  //     .then(result => {\n  //       if(result.id){\n  //         setInfo({\n  //           ...userInfo, \n  //           user: result\n  //         })\n  //       }\n  //     })\n  //   }\n  // }, []\n  // );\n\n  const signIn = (user) => {\n    fetch(\"http://localhost:3000/login/\", {\n        method: \"POST\",\n        headers: {\n            \"Accept\": \"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            user: {\n                username: user.username,\n                password: user.password\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(result => {\n        console.log(result);\n        if (result.token){\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('username', result.username);\n        localStorage.setItem('user_id', result.user_id);\n        setInfo({\n            ...userInfo,\n            user: result.user\n            });\n        navigate(\"/home\");\n        }\n        else {\n            setInfo({\n              ...userInfo,\n              error: result.error\n            });\n        }\n    })\n  }\n\n  return (\n    <div className=\"App\">\n      <Navbar user={localStorage.getItem('username')}/>\n      <SignIn signIn={signIn} error={userInfo['error']} />\n    </div>\n  );\n} \n\nexport default LoginPage;"],"mappings":";;;;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,OAAOC,MAAM,MAAM,yBAAyB;AAE5C,OAAOC,MAAM,MAAM,sBAAsB;AAEzC,IAAMC,SAAS,GAAG,SAAZA,SAAS,GAAS;EACtB,IAAMC,QAAQ,GAAGJ,WAAW,EAAE;EAAC,gBACHH,QAAQ,CAAC;MACnCQ,IAAI,EAAE,CAAC,CAAC;MACRC,KAAK,EAAE;IACT,CAAC,CAAC;IAAA;IAHKC,QAAQ;IAAEC,OAAO,kBAKxB;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEA,IAAMC,MAAM,GAAG,SAATA,MAAM,CAAIJ,IAAI,EAAK;IACvBK,KAAK,CAAC,8BAA8B,EAAE;MAClCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,QAAQ,EAAE,kBAAkB;QAC5B,cAAc,EAAE;MACpB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QACjBV,IAAI,EAAE;UACFW,QAAQ,EAAEX,IAAI,CAACW,QAAQ;UACvBC,QAAQ,EAAEZ,IAAI,CAACY;QACnB;MACJ,CAAC;IACL,CAAC,CAAC,CACDC,IAAI,CAAC,UAAAC,QAAQ;MAAA,OAAIA,QAAQ,CAACC,IAAI,EAAE;IAAA,EAAC,CACjCF,IAAI,CAAC,UAAAG,MAAM,EAAI;MACZC,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC;MACnB,IAAIA,MAAM,CAACG,KAAK,EAAC;QACjBC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,MAAM,CAACG,KAAK,CAAC;QAC3CC,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEL,MAAM,CAACL,QAAQ,CAAC;QACjDS,YAAY,CAACC,OAAO,CAAC,SAAS,EAAEL,MAAM,CAACM,OAAO,CAAC;QAC/CnB,OAAO,mBACAD,QAAQ;UACXF,IAAI,EAAEgB,MAAM,CAAChB;QAAI,GACf;QACND,QAAQ,CAAC,OAAO,CAAC;MACjB,CAAC,MACI;QACDI,OAAO,mBACFD,QAAQ;UACXD,KAAK,EAAEe,MAAM,CAACf;QAAK,GACnB;MACN;IACJ,CAAC,CAAC;EACJ,CAAC;EAED,oBACE;IAAK,SAAS,EAAC,KAAK;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBAClB,oBAAC,MAAM;IAAC,IAAI,EAAEmB,YAAY,CAACG,OAAO,CAAC,UAAU,CAAE;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EAAE,eACjD,oBAAC,MAAM;IAAC,MAAM,EAAEnB,MAAO;IAAC,KAAK,EAAEF,QAAQ,CAAC,OAAO,CAAE;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EAAG,CAChD;AAEV,CAAC;AAED,eAAeJ,SAAS"},"metadata":{},"sourceType":"module"}